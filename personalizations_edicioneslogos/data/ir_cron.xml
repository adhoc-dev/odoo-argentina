<?xml version='1.0' encoding='UTF-8'?>
<odoo>
  <record model="ir.cron" id="ir_cron_37">
    <field name="name">Carrito de compra abandonado</field>
    <field name="sequence">5</field>
    <field name="model_id" ref="delivery.model_sale_order"/>
    <field name="state">code</field>
    <field name="binding_type">action</field>
    <field name="code">

for sale in env['sale.order'].search([('is_abandoned_cart', '=', True),('cart_recovery_email_sent', '=', False)]):
    try:
        template = env.ref('website_sale.mail_template_sale_cart_recovery')
        sale.message_post_with_template(template.id)
        sale.write({'cart_recovery_email_sent': True})
        
    except Exception as e:
        log(str(e))


</field>
    <field eval="True" name="active"/>
    <field name="interval_number">1</field>
    <field name="interval_type">hours</field>
    <field name="numbercall">-1</field>
    <field eval="False" name="doall"/>
    <field name="priority">5</field>
  </record>
</odoo>
