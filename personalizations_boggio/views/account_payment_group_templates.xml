<?xml version='1.0' encoding='UTF-8'?>
<odoo>
  <template id="boggio_payment" inherit_id="l10n_ar_ux.report_payment_group_document">
    <span t-raw='"Cheque %s nro %s - %s" % ("electrónico " if line.checkbook_id.issue_check_subtype == "electronic" else "", line.name, line.bank_id.name or line.journal_id.name)' position="replace">
      <span t-raw='"Cheque %s nro %s - %s" % ("electrónico " if (line.checkbook_id.issue_check_subtype == "electronic" or line.journal_id.book_group_id.id == 48) else "", line.name, line.bank_id.name or line.journal_id.name)'/>
    </span>
    <xpath expr="//span[@t-field='o.partner_id.commercial_partner_id.name']//../strong" position="replace">
      <span t-raw="o.partner_type == 'supplier' and 'Proveedor: ' or 'Cliente: '"/>
      
    </xpath>
    <xpath expr="//span[@t-field='o.partner_id.l10n_ar_afip_responsibility_type_id']//../strong[1]" position="replace">
       <span>Cond. IVA: </span>
    </xpath>
    
    <xpath expr="//t[@t-esc='o.partner_id.l10n_latam_identification_type_id.name or o.company_id.country_id.vat_label']//..//..//strong" position="replace">
      <t t-esc="o.partner_id.l10n_latam_identification_type_id.name or o.company_id.country_id.vat_label" id="inv_tax_id_label" />:
    </xpath>
    <span t-field="o.partner_id.commercial_partner_id.name" position="replace">
      <strong><t>$0</t></strong>
    </span>
    <span t-field="o.partner_id.l10n_ar_afip_responsibility_type_id" position="replace">
      <strong><t>$0</t></strong>
    </span>
    <span t-esc="o.partner_id.l10n_ar_formatted_vat or o.partner_id.vat" position="replace">
      <strong><t>$0</t></strong>
    </span>
    <t t-foreach="o.mapped('payment_ids.check_ids').sorted(key=lambda r:r.payment_date or r.issue_date)" position="after">
      <span t-if="o.mapped('payment_ids.check_ids').sorted(key=lambda r:r.payment_date or r.issue_date)" t-esc="'Cant Cheques: %s' % len(o.mapped('payment_ids.check_ids').sorted(key=lambda r:r.payment_date or r.issue_date))"/>
    </t>
    <span t-field="o.notes" position="after">
      <br/>
      Fecha de Creacion: <strong><span t-field="o.create_date"/></strong>
       <br/>
      Usuario Creador:  <strong><span t-field="o.create_uid"/></strong>
    </span>
    <span t-esc="o.partner_id.l10n_ar_formatted_vat or o.partner_id.vat" position="after">
     <span t-esc="o.partner_id.commercial_partner_id.x_desc_pago_prov"/>
    </span>
    <table name="open_table" position="after">
      <table class="table table-sm o_main_table" name="open_table_banks" t-if="o.partner_type=='customer' and o.partner_id.bank_ids" groups="l10n_ar_ux.group_include_pending_receivable_documents">
        <thead>
            <tr>
                <th class="text-left"><span>Banco</span></th>
                <th class="text-left"><span>Nro. de Cuenta</span></th>
            </tr>
        </thead>
        <tbody>
            <t t-foreach="o.partner_id.bank_ids" t-as="line">
                <tr>
                    <td><span t-field="line.bank_id.name"/></td>
                    <td><span t-field="line.acc_number"/></td>
                </tr>
            </t>
        </tbody>
    </table>
      <br/>
      <strong class="text-left">SON:</strong>
      <span t-esc="o.currency_id.amount_to_text(o.payments_amount)"/>
      <br/>
      <span t-if="o.partner_type=='supplier'">
      Total Pendiente: <strong><span class="text-nowrap" t-raw="abs(sum(o.env['account.move.line'].search([('partner_id', '=', o.partner_id.commercial_partner_id.id), ('account_id.internal_type', '=', 'payable'), ('reconciled', '=', False), ('account_id.deprecated', '=', False), ('move_id.state', '=', 'posted'), ('company_id', '=', o.company_id.id)]).mapped('amount_residual')))" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: o.currency_id}"/></strong>
      </span>
    </table>
    <table name="open_table" position="attributes">
      <attribute name="t-if">o.partner_type=='customer' and o.partner_id.commercial_partner_id.x_detalle_deuda_facturas in (2,3) and o.partner_id.id not in (84779,51340,54396,50407)</attribute>
    </table>
  </template>
</odoo>